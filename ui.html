<!DOCTYPE html>
<html>
  <body>
    <div id="original"></div>
    <button id="translate">Traducir</button>
    <script>
      let originalText = "";

      onmessage = (event) => {
        if (event.data.pluginMessage.type === "TEXT_SELECTED") {
          originalText = event.data.pluginMessage.text;
          document.getElementById("original").innerText = originalText;
        }
      };

      document.getElementById("translate").onclick = async () => {
        const response = await fetch("https://api-translate-livid.vercel.app/api/translate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: originalText })
        });

        const data = await response.json();
        parent.postMessage(
          { pluginMessage: { type: "TRANSLATED_TEXT", text: data.translatedText } },
          "*"
        );
      };
    </script>
  </body>
</html>
